% -*- coding: utf-8-unix -*-
\documentclass{article}
\usepackage[bottom=2.5cm, top=2.5cm, left=4.5cm, right=4.5cm]{geometry}
\usepackage{fontspec} 
\usepackage{polyglossia}
    \setmainlanguage[spelling=new]{british}
\usepackage{microtype,booktabs,xcolor,paralist,nicefrac}
\usepackage{mathtools,amsthm,amsrefs}
\mathtoolsset{mathic}

\swapnumbers
\newtheorem{thm}{Theorem}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{note}[thm]{Note}
\newtheorem{eg}[thm]{Example}
\newtheorem{claim}[thm]{Claim}


\newcommand{\abs}[1]{\left|#1\right|}
\renewcommand{\vec}[1]{\mathbf{#1}}


\usepackage{tabularx}
\newcolumntype{L}{>{\raggedright\arraybackslash}X}
\newcolumntype{R}{>{\raggedleft\arraybackslash}X}
\newcolumntype{C}{>{\centering\arraybackslash}X}

\begin{document}
\section*{Limits}
In the following we consider an Eschenburg space \(E\) with parameters \(k_1,k_2,k_3\), \(l_1,l_2,l_3\).  Write \(\abs{r} := |H^4(E)|\) and \(s_2 := s_2(E)\).

\begin{claim}
  If \(\abs{r} \leq R\) and \(\abs{k_i},\abs{l_i} \leq P\), then in order for the computations of the invariants to be reliable, the data types used need to meet the following requirements:
  \begin{center}
    \begin{tabular}{rp{20em}}
      \verb+INT_R+ & (signed) integer with capacity of at least ... bits \\
      \verb+INT_P+ & (signed) integer with capacity of at least ... bits \\
      \verb+INT_KS+ & (signed) integer with capacity of at least ... bits \\
      \verb+FLOAT_KS+ & float with significand of at least ... bits
    \end{tabular}
  \end{center}
  These requirements are sufficient provided the implementation of the sin function  \verb+boost/math/special_functions/sin_pi.hpp+
  is as exact as the data type \verb+FLOAT_KS+ permits.
\end{claim}

\begin{eg}
  The default data types specified in \verb+config.h+ are:
  \begin{center}
    \begin{tabular}{rp{20em}}
      \verb+INT_R+ & \texttt{:= long} (at east $..$ bit) \\
      \verb+INT_P+ & \texttt{:= long} (at least $..$ bit) \\
      \verb+INT_KS+ & \texttt{:= long long} (at least $..$ bit) \\
      \verb+FLOAT_KS+ & \texttt{:= double} ($53$ bit significand)
    \end{tabular}
  \end{center}
  The implementation of \verb+sin_pi+ for \texttt{double} using the GNU C++ compiler is exact\footnote{%
    \url{http://www.boost.org/doc/libs/1_65_1/libs/math/doc/html/math_toolkit/powers/sin_pi.html}}.
  Thus, by the above claim and the following note, computations are reliable in the following ranges:
  \begin{compactitem}
  \item For analysing a single space with parameters \(\abs{k_i}, \abs{l_i} \leq ...\).

  \item  For generating list of spaces in standard parametrization with \(\abs{r} \leq ...\).    
  \end{compactitem}
\end{eg}

\begin{note}\label{lem:P-vs-R}
  For any Eschenburg space, 
  \(\abs{k_i}, \abs{l_i} \leq P\) implies \(\abs{r} \leq 6 P^2\).
  For an Eschenburg space in standard presentation, \(\abs{k_i}, \abs{l_i} \leq 2\abs{r}^{1/2}\).
\end{note}


{\color{gray}
\begin{prop}
  Suppose \(E\) is a space in standard presentation.
  Then denominator and numerator of \(\abs{s_2}\) are bounded by 
  \(
      2^{17,1}·\abs{r}^{5/2}.
  \)
  The absolute values of the integers \(d\), \(q\) and \(45\ell_i\) appearing in \eqref{eq:s2} are bounded by the same value.

  Suppose \(E\) is an Eschenburg space such that the absolute values of all paremeters are bounded by \(P\).  Then the denominator and the numerator of \(\abs{s_2}\) are bounded by 
  \(
    2^{16,7}·\abs{r}^{5}.
  \)
\end{prop}
}


\subsection{Verification of the claim for the integer data types}
The invariant \(s_2\) is computed by a formula of the form
\begin{align}\label{eq:s2}
  \notag  s_2   &= (q-2)/d + \ell_1 + \ell_2 + \ell_3\\
                &= \frac{45(q-2) + [45\ell_1] + [45\ell_2] + [45\ell_3]}{45d}
\end{align}  
where \(\ell_i\) are lens space invariants such that \(45\ell_i\) is an integer.  

\begin{lem}\label{lem:s2}
  Suppose the absolute values of \(\abs{k_i}\) and \(\abs{l_i}\) are bounded by \(P\).  Then  the denominator and the numerator of \(\abs{s_2}\) are bounded as follows:
  \begin{align*}
    \abs{\text{numerator}}   &\leq 2·3^3·5·P^4\\
    \abs{\text{denominator}} &\leq 2^7·3^3·5·\abs{r}·P^3
  \end{align*}
  (provided \(P\) and \(\abs{r}\) are sufficienctly large).  The absolute values of the integers \(d\), \(q\) and \(45\ell_i\) appearing in \eqref{eq:s2} are bounded by the same value.
\end{lem}
 
\begin{proof}
The absolute value of \(q\) in \eqref{eq:s2} is bounded by a sum of six squares of differences of parameters \((k_i-l_j)\), so 
\begin{align}
  \abs{q}&\leq 6(2P)^2 \leq 2^3·3·P^2.\\
  \intertext{
  The absolute value of \(d\) is bounded by}
  \notag 
  \abs{d} &\leq 3 · 2^4 · \abs{r} · (2P)^3\\
         &\leq 2^7·3·\abs{r} · P^3
\end{align}
An upper bound for the lens invariants \(\ell_i\) is estimated in Lemma~\ref{L-bounds} below. [\dots]
{\color{gray} Each lens invariant \(\ell_i\) is a sum of \(p\) summands of the form
\[
  \abs{cos(…)-1}
  ·\abs{1/sin\left(\frac{k\pi p_1}{p}\right)}
  ·\abs{1/sin\left(\frac{k\pi p_2}{p}\right)}
  ·\abs{1/sin\left(\frac{k\pi p_3}{p}\right)}
  ·\abs{1/sin\left(\frac{k\pi p_4}{p}\right)}
\]
When \(\abs{x}\) is small, \(sin(x) \sim x\), so an upper bound for such a summand can be estimated as
\begin{align*}
   \abs{cos(…)-1}
    ·\abs{\frac{p}{k\pi p_1}}
    ·\abs{\frac{p}{k\pi p_2}}
    ·\abs{\frac{p}{k\pi p_3}}
    ·\abs{\frac{p}{k\pi p_4}}
 \leq 2·\frac{\abs{p}^4}{\pi^4k^4}
  \leq 2^{-5} \frac{p^4}{k^4} 
\end{align*}
Summing over \(k\), we obtain:
\begin{align*}
  \abs{\ell_i} 
  &\leq 2^{-5}\abs{p}^4 \sum_{k=1}^{\abs{p}}\left(\frac{1}{k^4}\right)\\
  &\leq 2^{-4}\abs{p}^4.
\end{align*}
Finally, \(\abs{p}\leq 2P\)  because the parameter \(p\) is a difference of two parameters of \(E\), so
\begin{equation}
\abs{\ell_i} \leq P^4 .
\end{equation}
}
Thus, altogether we obtain the following bounds for numerator and denominator of \(s_2\):
\begin{align*}
  \abs{\text{numerator}} &\leq 45·(3·2^3·P^2 + 3·P^4) \leq 2·3^3·5·P^4\\
  \abs{\text{denominator}} &\leq 45·\abs{d} \leq 2^7·3^3·5· R P^3
\end{align*}
\end{proof}

\begin{proof}[Proof of Lemma~\ref{lem:P-vs-R}]
The first implication is clear from \(r = \sigma_2(k_1,k_2,k_3) - \sigma_2(l_1,l_2,l_3)\).
For the second implication, note that all parameters execpt \(k_3\) are bounded by \(\sqrt{R}\) in the standard representation; the parameter \(k_3\) is bounded only by \(2\sqrt{R}\).
\end{proof}


\begin{proof}[Proof of the proposition]
The proposition is immediate from the two lemmas and the estimates of upper bounds for the values of \(q\), \(d\) and \(45\ell_i\) appearing in the proof of Lemma~\ref{lem:s2}.  In both cases, it is clear that for sufficiently large \(R\) and \(P\) the bound for the denominator of \(\abs{s_2}\) is the largest bound that occurs.  For Eschenburg spaces in standard presentation, this bound is 
\(
2^{10}·3^3·R^{5/2} \leq 2^{17,1}·R^{5/2}.
\)
For general Eschenburg spaces, this bound is
\(
    2^{8}·3^4·5·P^{5} \leq 2^{16,7}·P^5
\).
\end{proof}


\subsection{Verification of the claim for the float data type}
Recall \(\csc(x) := 1/\sin(x)\).

\begin{lem}
  Let \(\epsilon>0\) be sufficiently small (\(\leq \nicefrac{1}{100}\)).  Then
  \(\abs{\csc(\pi·x)} \leq 2^{-1.6} \epsilon^{-1}\) for any real number \(x\) whose distance to the nearest integer is at least~\(\epsilon\).
\end{lem}
\begin{proof}
  It suffices to show that \(\sin(\pi·x) \geq 2^{1.6} \epsilon\) for any real \(x\in [\epsilon,\nicefrac{1}{2}]\), where \(\epsilon \in (0,\nicefrac{1}{100})\) is some given lower bound.  It is known that \(\sin(\pi x) \geq \pi x·\cos(\pi x)\) for all \(x\in [0,\nicefrac{1}{2}]\), so for \(x\in [\epsilon,\nicefrac{1}{2}]\) we find that 
  \[
    \sin(\pi x) \geq \sin(\pi\epsilon) \geq \pi\epsilon·cos(\pi\epsilon).
  \]
  If \(\epsilon\) is sufficiently small, then \(\pi·\cos(\pi\epsilon)\) is close to \(\pi\).
  The result is obtained by explicitly calculating this value for \(\epsilon = \nicefrac{1}{100}\).
% cos(\pi/10) = 2^{−0,072397019}
% \pi         = 2^{ 1,651496129}
%
% So \pi (cos(\pi/10)) > 2^{1,6} 
%
\end{proof}

The lens invariants are computed using the function
\[
  L(x_0,x_1,x_2,x_3,x_4) 
  := (\cos(\pi x_0)-1)
  · \textstyle\prod_{i=1}^{4} \csc(\pi x_i).
\]
\begin{lem}\label{L-bounds}
  Let \(\epsilon\) be as above.  Suppose all coordinates of \(\vec x = (x_0,x_1,x_2,x_3,x_4)\) have a distance of a least \(\epsilon\) to the nearest integer. Then
  \(
  \abs{L(\vec x)} \leq 2^{-5.4}\epsilon^{-4}
  \).
  
  Moreover, for any \(\vec y\) satisfying the same assumptions and contained in a \(\delta\)-cube around \(\vec x\),
  \(
  \abs{L(\vec x) - L(\vec y)} \leq  2^{-5.6}\epsilon^{-5}\delta
  \)
  % 
  % for any \(\vec y\) in a \(\delta\)-cube around \(\vec x\), i.\,e.\ for any \(\vec y\) satisfying  \(\abs{x_i - y_i} \leq \epsilon\) for all~\(i\).
\end{lem}

\begin{proof}
  The previous lemma implies that \(\abs{L(\vec x)} \leq 2\cdot (2^{-1.6}\epsilon^{-1})^4\), so the first claim is immediate. For the second claim, we use the multivariate mean value theorem.  Assuming that the absolute values of the partial derivates \(\partial_{x_i} L\) are bounded on the given \(\delta\)-cube by some bound \(U'\), the theorem implies that 
  \[
    \abs{L(\vec x)-L(\vec y)} \leq 5·U'·\delta.
  \]
  for all \(\vec y\) in the cube.  The derivatives of \(L\) are easily computed using the fact that \(\partial_x \csc(\pi x)  = -\pi \cos(\pi x) \csc(\pi x)^2\).  One easily sees that if \(\abs{\csc(\vec y)}\leq U\) on the cube, then \(\abs{\partial_{x_i} L(\vec y)} \leq \pi U^5\) on the cube.  So we can take \(U' := \pi U^5\) with \(U\) the upper bound from the previous lemma.  This gives
  \[
    \abs{L(\vec x)-L(\vec y)} 
    \leq 5\pi·(2^{-1.6}\epsilon^{-1})^5·\delta 
    \leq 2^{-5.6}\epsilon^{-5}\delta,
    %
    % 5\pi = 2^{3,973424224} <= 2^4
    % 
  \]
  as claimed.
\end{proof}

The lens invariant \(\ell_i\) is computed by 
\begin{equation}\label{eq:ell}
  \ell_i := \sum_{v=1}^{\abs{p}-1} L(\vec x^{(v)})
\end{equation}
where the coordinates of \(\vec x^{(v)}\) have the form \(\frac{v p_i}{p}\) and each of \(p\), \(p_1\), \dots, \(p_4\) is a sum difference of parameters \(k_i-l_j\).

\begin{prop}
  Suppose the parameters \(k_i\), \(l_i\) are bounded by \(P\).  
  Then
  \[
    45\ell_i \leq 2^5 P^5.
  \]
  Moreover, if \(\vec x^{(1)}\), \(\vec x^{(2)}\), \(\dots\) are the quintuples appearing in \eqref{eq:ell},  and if \(\vec y^{(1)}\), \(\vec y^{(2)}\), \(\dots\) are quintuples such that each \(\vec y^{(v)}\) is contained in a \(\delta\)-cube around \(\vec x^{(v)}\) with \(\delta \leq P^{-2}\), then
  \(
  \abs{45\ell_i(\vec x^{(v)}) - 45\ell_i(\vec y^{(v)})} \leq ...
  \)
\end{prop}
\begin{proof}
  If each of \(k_i\) and \(l_i\) is bounded by \(P\), then each of the parameters \(p\), \(p_1\), \dots, \(p_4\) is bounded by \(2P\).   Thus, we can apply the previous lemma to each \(L(\vec x^{(v)})\) with \(\epsilon = 1/(2P)\) to obtain \(L(\vec x^{(v)}) \leq 2^{-5.4}(2P)^4 = 2^{-1.4}P^4\).
  Taking a \((\abs{p}-1)\)-fold sum and multiplying by \(45\), we find
  \[
    45\ell_i(\vec x) 
    \leq 45·(2P)·2^{-1.4} P^4
    \leq 2^5 P^5
    %
    % 45 < 2^{5,49185309}
    %
  \]
  To apply the second part of the previous lemma, we first need to decrease \(\epsilon\) to \(\epsilon-\delta\).
  (\epsilon-\delta)^{-5} 


\end{proof}





{\color{gray}
\begin{table}[b]
  \begin{center}
  \begin{tabular}{rrrrr} 
    \toprule
    data type  & bits    & \text{range}    & standard \(R\)  & general \(P\)   \\
    \midrule                               
    int / long & \(32\)  & \(\pm 2^{31}\)  & \(47\)          & \(7\)           \\ 
    long long  & \(64\)  & \(\pm 2^{63}\)  & \(336\,442\)    & \(613\)         \\
    ??         & \(128\) & \(\pm 2^{127}\) & \(1,7·10^{13}\) & \(4\,372\,418\) \\
    \bottomrule
  \end{tabular}
  % 
  % log_2(y) = ln(y)/ln(2)
  % 
  % 2^{17,1}·R^{5/2} <=  2^x
  % <=>                R <= 2^{2/5 (x-17,1)}
  % 
  % 2^{16,7}·P^5     <=  2^x 
  % <=>                P <= 2^{1/5 (x-16,7)}
  % 
  \caption{Different data types and the resulting bounds \(R\) on \(\abs{r}\) (for spaces in standard presentation) and \(P\) on the parameters (for any presentation), according to the above proposition.  (The values in the first line of the table may not actually be ``sufficiently large'' for the proposition to apply.)}
\end{center}
\end{table}
}


\end{document}

%%% Local Variables: 
%%% coding: utf-8
%%% mode: latex
%%% TeX-engine: xetex
%%% End: 